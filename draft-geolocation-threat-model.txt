



Network Working Group                                          C.A. Wood
Internet-Draft                                                Cloudflare
Intended status: Informational                            26 August 2021
Expires: 27 February 2022


                       A Geolocation Threat Model
                 draft-geolocation-threat-model-latest

Abstract

   This document describes a threat model for geolocation services and
   interactions with users.

Discussion Venues

   This note is to be removed before publishing as an RFC.

   Discussion of this document takes place on the mailing list (), which
   is archived at .

   Source for this draft and an issue tracker can be found at
   https://github.com/chris-wood/geo-ip-threat-model.

Status of This Memo

   This Internet-Draft is submitted in full conformance with the
   provisions of BCP 78 and BCP 79.

   Internet-Drafts are working documents of the Internet Engineering
   Task Force (IETF).  Note that other groups may also distribute
   working documents as Internet-Drafts.  The list of current Internet-
   Drafts is at https://datatracker.ietf.org/drafts/current/.

   Internet-Drafts are draft documents valid for a maximum of six months
   and may be updated, replaced, or obsoleted by other documents at any
   time.  It is inappropriate to use Internet-Drafts as reference
   material or to cite them other than as "work in progress."

   This Internet-Draft will expire on 27 February 2022.

Copyright Notice

   Copyright (c) 2021 IETF Trust and the persons identified as the
   document authors.  All rights reserved.

   This document is subject to BCP 78 and the IETF Trust's Legal
   Provisions Relating to IETF Documents (https://trustee.ietf.org/
   license-info) in effect on the date of publication of this document.
   Please review these documents carefully, as they describe your rights
   and restrictions with respect to this document.  Code Components
   extracted from this document must include Simplified BSD License text
   as described in Section 4.e of the Trust Legal Provisions and are
   provided without warranty as described in the Simplified BSD License.

Table of Contents

   1.  Introduction
   2.  Requirements Notation
   3.  Geolocation Background
     3.1.  Terminology
     3.2.  Geolocation Use Cases
     3.3.  Geoocation Sources
     3.4.  Geolocation Properties
   4.  Threat Model
   5.  Security Considerations
   6.  IANA Considerations
   7.  Normative References
   Author's Address

1.  Introduction

   Many online services perform geolocation using IP-based databases.
   In general, such databases map IP addresses to geographic locations.
   Most client devices also offer APIs for retrieving geographic
   locations.  Providers of these databases and APIs often combine
   multiple, and sometimes private or privileged, sources of information
   for the mappings.  Moreover, the details of mapping construction is
   proprietary.

   One aspect these services do have in common is that the mapping lacks
   authenticity.  In particular, neither online services nor client APIs
   provide any assurance that the location output is correct.  This is
   problematic considering that such location information is often used
   for critical applications, including security and policy enforcement,
   content customization, and advertisements.

   Addressing these shortcomings requires clarity on the problems being
   solved by geolocation mechanisms.  Moreover, for those problems, it
   is important to identify the threat model describing the behavior of
   different system entities.  This document is an attempt to start the
   discussion on these topics.

2.  Requirements Notation

   The key words "MUST", "MUST NOT", "REQUIRED", "SHALL", "SHALL NOT",
   "SHOULD", "SHOULD NOT", "RECOMMENDED", "NOT RECOMMENDED", "MAY", and
   "OPTIONAL" in this document are to be interpreted as described in
   BCP 14 [RFC2119] [RFC8174] when, and only when, they appear in all
   capitals, as shown here.

3.  Geolocation Background

   This section describes use cases for geolocation services and sources
   for this information.

3.1.  Terminology

   The following terms are used throughout this document.

   Geolocation:  The geographic location of an entity, e.g., geographic
      coordinates.

   Anchor:  An entity with a well-known and specific geolocation.

   Relying Party (RP):  An entity that wants to learn the geolocation of
      another entity.

   User:  The entity to which geolocation information typically
      pertains.

3.2.  Geolocation Use Cases

   User geolocation has a number of critical use cases on the web,
   including, though not limited to:

   *  Content customization: Content varies in time and space.  For
      example, an Internet search for "nearby restaurants" will
      necessarily return different results for different users depending
      on their location.  Advertisements for content may also vary based
      on location.  Advertisements in one region may not be available in
      another region.  These use cases do not require absolute
      geolocation information, i.e., it may be accurate within some
      margin of error.

   *  Compliance: In some cases, content available in one region is not
      allowed to be available in another region, perhaps due to
      copyright restrictions or other regional reasons.  User location
      is often used to infer these regions and enforce these rules.
      Popular streaming services, for example, apply geo fences based on
      user location.  These use cases require absolute geolocation
      information, i.e., there is no margin of error in the information.

   *  Fraud and abuse detection: Many anti-bot detection and mitigation
      systems use user location, or proxies for location such as IP
      addresses, as a signal for bot detection behavior.  Observing many
      suspicious connections coming from the same location is often,
      though not necessarily, indicative of malicious behavior.

   Most of these use cases impact user experience in one way or another.
   Others go beyond user experience and have legal or jurisdictional
   implications.

3.3.  Geoocation Sources

   There are at least two classes of geolocation APIs available.  A
   description of each follows.

   *  Client-side APIs: These include APIs such as CoreLocation, the W3C
      Geolocation API, and so on, which provide clients with a simple
      API for getting location.  In most cases, these APIs are gated by
      user consent.  That is, end-users must explicitly allow the API to
      reveal the user location.

   *  Server-side APIs: The most popular server-side API is likely
      MaxMind, which provides a proprietary and closed API for mapping
      an IP address to a location, along with other metadata about the
      IP address.  Some of these services offer a free, rate-limited
      API, whereas others offer paid variants with more options.  Unlike
      client-side APIs, servers generally have access to client IP
      addresses without user consent (absent proxying technologies such
      as Private Relay or Tor).

   The sources of truth for these geolocation APIs vary widely.  They
   include, but are not limited to GPS information, network signalling
   information (IP, RFID, WiFi and Bluetooth MAC addresses), GSM/CDMA
   cellular network IDs, and even user input.  In most cases, the
   signals that feed into geolocation information are unauthenticated:
   there is no proof that the output is actually correct or originated
   from a trusted source.  Moreover, there is no existing notion of a
   trusted source of geolocation information as there is no way for
   sources to present proof of correctness or authenticity.

3.4.  Geolocation Properties

   There are a number of properties one might consider with respect to
   geolocation information.  A description of some properties follows.

   *  Liveness or freshness: Geolocation information may be fresh, i.e.,
      computed or otherwise determined on demand, or it may not be.
      Geolocation information that is not fresh can be used (or abused)
      by entities to influence their perceived location after having
      changed their actual geolocation information.

   *  Accuracy: Geolocation information be precise, i.e., pointing to a
      specific latitude and longitude, or more coarse, encompassing a
      larger area of physical distance.

   *  Consent: Geolocation may be dependent on user consent as explicit
      information sent to or revealed from one entity to another, or it
      may be implicit, and inferred without consent.

   *  Confidence: Geolocation information correctness may be a random
      variable, varying in terms of how confident or correct the
      information may be.

   *  Composition: Geolocation information may be composed to produce
      new geolocation information.  For example, two different
      geolocation sources may be combined to produce a single type of
      geolocation information.

4.  Threat Model

   In most geolocation interactions, a relying party (server) wants to
   learn the location of a user (client) for the purposes of addressing
   one or more of the use cases in Section 3.2.  Depending on the
   implementation, clients may or may not require user consent before
   revealing geolocation information to the server.

   In this interaction, we consider the following server and source
   threat models:

   1.  Servers are malicious and want to try and learn precise client
       location or identity, even without consent from the user.  This
       allows servers to interact with clients or any other entity as
       needed to subvert the user's desired privacy goals.

   2.  Some subset of geolocation sources (and APIs) are trusted,
       whereas others are assumed to be malicious.  Indeed, some amount
       of geolocation sources must be assumed to be trustworthy for any
       use cases to work reliably.

   For all use cases, servers require some trusted geolocation
   information from the client.  How this information is produced varies
   depending on the client threat model: If the client is untrusted,
   then the location information needs to be trusted.  Otherwise, if the
   client is trusted, then the location information needs to be somehow
   bound to the trusted client.

   Dishonest users that intentionally change, alter, or influence their
   geolocation are out of scope for this threat model.  In particular,
   dishonest users operating clients can lie about their geolocation
   information, either by using applications or software that sends fake
   information to the server, or by otherwise modifying what information
   the server sees, e.g., by changing egress IP address in server
   connections.  Servers cannot distinguish between honest and dishonest
   clients without additional assumptions.

5.  Security Considerations

   This document describes a threat model for geolocation use cases,
   intended to help discussions on this problem.

6.  IANA Considerations

   This document makes no IANA requests.

7.  Normative References

   [RFC2119]  Bradner, S., "Key words for use in RFCs to Indicate
              Requirement Levels", BCP 14, RFC 2119,
              DOI 10.17487/RFC2119, March 1997,
              <https://datatracker.ietf.org/doc/html/rfc2119>.

   [RFC8174]  Leiba, B., "Ambiguity of Uppercase vs Lowercase in RFC
              2119 Key Words", BCP 14, RFC 8174, DOI 10.17487/RFC8174,
              May 2017, <https://datatracker.ietf.org/doc/html/rfc8174>.

Author's Address

   Christopher A. Wood
   Cloudflare

   Email: caw@heapingbits.net
